{"version":3,"sources":["tiles-management-compiled.js"],"names":["define","$","Base","registry","Modal","Sortable","I18n","Pattern","extend","name","trigger","parser","defaults","init","_this","managerId","options","useModal","isIE","ua","window","navigator","userAgent","msie","indexOf","trident","edge","customEventPolyfill","CustomEvent","event","params","bubbles","cancelable","detail","undefined","evt","document","createEvent","initCustomEvent","prototype","Event","initializeAddButton","button","url","$button","container","next","length","parent","append","hide","load","find","each","addTileModal","actionOptions","redirectOnResponse","redirectToUrl","location","href","on","slideDown","slideToggle","enableEditButtons","tile","$tile","deleteModal","templateOptions","classModal","onSuccess","self","response","state","xhr","form","reloadWindow","editModal","click","e","preventDefault","$element","currentTarget","ajax_load","invalidIECache","Date","getTime","get","attr","done","data","result","JSON","parse","console","error","$span","hasClass","removeClass","addClass","html","toggleClass","fail","mouseenter","show","mouseleave","enableSorting","absoluteUrl","baseUrl","sortable","selector","drop","$el","delta","tileIds","map","index","obj","tileid","stringify","_authenticator","message","enablePatterns","tags","className","split","cssClass","pattern","substring","initPattern","TypeError","addLoader","portalUrl","loadManager","contentlUrl","tilesInfosUrl","remove","dispatchEvent","addButton","tiledata","$buttons","portal_url","$current_buttons","clone","setAttribute","token","tile_type","tile_hidden","prepend","innerWidth","target","err","trace","i18n","domain","loadCatalog","_","MessageFactory","require"],"mappings":";;AAAAA,OAAO,0BAAP,EAAmC,CACjC,QADiC,EAEjC,UAFiC,EAGjC,cAHiC,EAIjC,uBAJiC,EAKjC,0BALiC,EAMjC,aANiC,EAOjC,gBAPiC,CAAnC,EAQG,UAASC,CAAT,EAAYC,IAAZ,EAAkBC,QAAlB,EAA4BC,KAA5B,EAAmCC,QAAnC,EAA6CC,IAA7C,EAAmD;AACpD;;AACA,MAAIC,UAAUL,KAAKM,MAAL,CAAY;AACxBC,UAAM,kBADkB;AAExBC,aAAS,uBAFe;AAGxBC,YAAQ,QAHgB;AAIxBC,cAAU,EAJc;AAKxBC,UAAM,gBAAW;AACf,UAAMC,QAAQ,IAAd;AACA,UAAMC,YAAY,KAAKC,OAAL,CAAaD,SAA/B;AACA,UAAME,WAAW,KAAKD,OAAL,CAAaC,QAAb,KAA0B,OAA3C;;AAEA,UAAMC,OAAQ,YAAW;AACvB,YAAIC,KAAKC,OAAOC,SAAP,CAAiBC,SAA1B;AACA,YAAIC,OAAOJ,GAAGK,OAAH,CAAW,OAAX,CAAX;AACA,YAAID,OAAO,CAAX,EAAc;AACZ;AACA,iBAAO,IAAP;AACD;;AAED,YAAIE,UAAUN,GAAGK,OAAH,CAAW,UAAX,CAAd;AACA,YAAIC,UAAU,CAAd,EAAiB;AACf;AACA,iBAAO,IAAP;AACD;;AAED,YAAIC,OAAOP,GAAGK,OAAH,CAAW,OAAX,CAAX;AACA,YAAIE,OAAO,CAAX,EAAc;AACZ;AACA,iBAAO,IAAP;AACD;;AAED;AACA,eAAO,KAAP;AACD,OAtBY,EAAb;;AAwBA,UAAMC,sBAAsB,SAAtBA,mBAAsB,GAAW;AACrC,YAAI,OAAOP,OAAOQ,WAAd,KAA8B,UAAlC,EAA8C,OAAO,KAAP;;AAE9C,iBAASA,WAAT,CAAqBC,KAArB,EAA4BC,MAA5B,EAAoC;AAClCA,mBAASA,UAAU;AACjBC,qBAAS,KADQ;AAEjBC,wBAAY,KAFK;AAGjBC,oBAAQC;AAHS,WAAnB;AAKA,cAAIC,MAAMC,SAASC,WAAT,CAAqB,aAArB,CAAV;AACAF,cAAIG,eAAJ,CACET,KADF,EAEEC,OAAOC,OAFT,EAGED,OAAOE,UAHT,EAIEF,OAAOG,MAJT;AAMA,iBAAOE,GAAP;AACD;;AAEDP,oBAAYW,SAAZ,GAAwBnB,OAAOoB,KAAP,CAAaD,SAArC;;AAEAnB,eAAOQ,WAAP,GAAqBA,WAArB;AACD,OAtBD;;AAwBAD,4BArDe,CAqDQ;;AAEvB,UAAMc,sBAAsB,SAAtBA,mBAAsB,CAASC,MAAT,EAAiBC,GAAjB,EAAsB;AAChD,YAAMC,UAAU3C,EAAEyC,MAAF,CAAhB;AACA,YAAIG,YAAYD,QAAQE,IAAR,CAAa,kBAAb,CAAhB;AACA,YAAID,UAAUE,MAAV,KAAqB,CAAzB,EAA4B;AAC1BH,kBAAQI,MAAR,GAAiBC,MAAjB,CAAwB,qCAAxB;AACAJ,sBAAYD,QAAQE,IAAR,CAAa,kBAAb,CAAZ;AACAD,oBAAUK,IAAV;AACAL,oBAAUM,IAAV,CAAeR,MAAM,uBAArB,EAA8C,YAAW;AACvD,gBAAI1B,QAAJ,EAAc;AACZ4B,wBAAUO,IAAV,CAAe,mBAAf,EAAoCC,IAApC,CAAyC,YAAW;AAClD,oBAAMC,eAAe,IAAIlD,KAAJ,CAAUH,EAAE,IAAF,CAAV,EAAmB;AACtCsD,iCAAe;AACbC,wCAAoB,IADP;AAEbC,mCAAerC,OAAOsC,QAAP,CAAgBC;AAFlB;AADuB,iBAAnB,CAArB;AAMAL,6BAAaM,EAAb,CAAgB,cAAhB,EAAgC,YAAW;AACzC3D,oBAAE,eAAF,EAAmBgD,MAAnB,CACE,kDACElC,SADF,GAEE,MAHJ;AAKD,iBAND;AAOD,eAdD;AAeD;;AAEDd,cAAE,IAAF,EAAQ4D,SAAR;AACD,WApBD;AAqBD,SAzBD,MAyBO;AACLhB,oBAAUiB,WAAV;AACD;AACF,OA/BD;;AAiCA,UAAMC,oBAAoB,SAApBA,iBAAoB,CAASC,IAAT,EAAe;AACvC;AACA,YAAMC,QAAQhE,EAAE+D,IAAF,CAAd;AACA,YAAI/C,QAAJ,EAAc;AACZgD,gBAAMb,IAAN,CAAW,sCAAX,EAAmDC,IAAnD,CAAwD,YAAW;AACjE,gBAAMa,cAAc,IAAI9D,KAAJ,CAAUH,EAAE,IAAF,CAAV,EAAmB;AACrCkE,+BAAiB;AACfC,4BAAY;AADG,eADoB;AAIrCb,6BAAe;AACbC,oCAAoB,KADP;AAEba,2BAAW,mBAASC,IAAT,EAAeC,QAAf,EAAyBC,KAAzB,EAAgCC,GAAhC,EAAqCC,IAArC,EAA2C;AACpD,sBAAIF,UAAU,SAAd,EAAyB;AACvBF,yBAAKpB,IAAL;AACAoB,yBAAKK,YAAL;AACD;AACF;AAPY;AAJsB,aAAnB,CAApB;AAcAT,wBAAYN,EAAZ,CAAe,cAAf,EAA+B,YAAW;AACxC3D,gBAAE,kBAAF,EAAsBgD,MAAtB,CACE,kDACElC,SADF,GAEE,MAHJ;AAKD,aAND;AAOD,WAtBD;;AAwBAkD,gBAAMb,IAAN,CAAW,oCAAX,EAAiDC,IAAjD,CAAsD,YAAW;AAC/D,gBAAMuB,YAAY,IAAIxE,KAAJ,CAAUH,EAAE,IAAF,CAAV,EAAmB;AACnCkE,+BAAiB;AACfC,4BAAY;AADG,eADkB;AAInCb,6BAAe;AACbC,oCAAoB;AADP;AAJoB,aAAnB,CAAlB;AAQD,WATD;AAUD;;AAEDS,cAAMb,IAAN,CAAW,0CAAX,EAAuDC,IAAvD,CAA4D,YAAW;AACrEpD,YAAE,IAAF,EAAQ4E,KAAR,CAAc,UAASC,CAAT,EAAY;AACxBA,cAAEC,cAAF;AACA,gBAAIC,WAAW/E,EAAE6E,EAAEG,aAAJ,CAAf;AACA,gBAAIjE,UAAU,EAAED,WAAWA,SAAb,EAAwBmE,WAAW,IAAnC,EAAd;AACA,gBAAIhE,IAAJ,EAAU;AACRF,sBAAQmE,cAAR,GAAyB,IAAIC,IAAJ,GAAWC,OAAX,EAAzB;AACD;AACDpF,cAAEqF,GAAF,CAASN,SAASO,IAAT,CAAc,MAAd,CAAH,oBAAyCxE,SAA/C,EAA0DC,OAA1D,EACGwE,IADH,CACQ,UAASC,IAAT,EAAe;AACnB,kBAAIA,SAASvD,SAAb,EAAwB;AACtB,oBAAMwD,SAASC,KAAKC,KAAL,CAAWH,IAAX,CAAf;AACAI,wBAAQC,KAAR,CAAcJ,OAAOI,KAArB;AACA;AACD;;AAED;AACA,kBAAIC,QAAQf,SAAS5B,IAAT,CAAc,QAAd,CAAZ;AACA,kBAAI2C,MAAMC,QAAN,CAAe,WAAf,CAAJ,EAAiC;AAC/BD,sBACGE,WADH,CACe,WADf,EAEGC,QAFH,CAEY,+BAFZ;AAGAH,sBAAM3C,IAAN,CAAW,QAAX,EAAqB+C,IAArB,CAA0B,MAA1B;AACD,eALD,MAKO;AACLJ,sBACGE,WADH,CACe,+BADf,EAEGC,QAFH,CAEY,WAFZ;AAGAH,sBAAM3C,IAAN,CAAW,QAAX,EAAqB+C,IAArB,CAA0B,MAA1B;AACD;;AAED;AACAlC,oBAAMmC,WAAN,CAAkB,YAAlB;AACD,aAxBH,EAyBGC,IAzBH,CAyBQ,UAASP,KAAT,EAAgB;AACpBD,sBAAQC,KAAR,CAAcA,KAAd;AACD,aA3BH;AA4BD,WAnCD;AAoCD,SArCD;;AAuCA7B,cACGqC,UADH,CACc,YAAW;AACrBrG,YAAE,IAAF,EAAQiG,QAAR,CAAiB,cAAjB;AACAjG,YAAE,IAAF,EACGmD,IADH,CACQ,kBADR,EAEGmD,IAFH;AAGD,SANH,EAOGC,UAPH,CAOc,YAAW;AACrBvG,YAAE,IAAF,EAAQgG,WAAR,CAAoB,cAApB;AACAhG,YAAE,IAAF,EACGmD,IADH,CACQ,kBADR,EAEGF,IAFH;AAGD,SAZH;AAaD,OA5FD;;AA8FA,UAAMuD,gBAAgB,SAAhBA,aAAgB,CAAS5D,SAAT,EAAoB;AACxC,YAAM6D,cAAczG,EAAE,MAAF,EAAUwF,IAAV,GAAiBkB,OAAjB,IAA4B1G,EAAE,MAAF,EAAUsF,IAAV,CAAe,MAAf,CAAhD;AACA,YAAMqB,WAAW,IAAIvG,QAAJ,CAAawC,UAAUO,IAAV,CAAe,YAAf,CAAb,EAA2C;AAC1DyD,oBAAU,iBADgD;AAE1DC,gBAAM,cAASC,GAAT,EAAcC,KAAd,EAAqB;AACzB,gBAAIA,UAAU,CAAd,EAAiB;AACf,kBAAMC,UAAUhH,EAAE,cAAF,EAAkBiH,GAAlB,CAAsB,UAASC,KAAT,EAAgBC,GAAhB,EAAqB;AACzD,uBAAOnH,EAAEmH,GAAF,EAAO3B,IAAP,GAAc4B,MAArB;AACD,eAFe,CAAhB;AAGA,kBAAIX,gBAAgBxE,SAApB,EAA+B;AAC7B,oBAAIlB,UAAU;AACZD,6BAAWA,SADC;AAEZmE,6BAAW,IAFC;AAGZ+B,2BAAStB,KAAK2B,SAAL,CAAeL,QAAQ3B,GAAR,EAAf,CAHG;AAIZiC,kCAAgBR,IAAItB,IAAJ,CAAS,OAAT;AAJJ,iBAAd;AAMA,oBAAIvE,IAAJ,EAAU;AACRF,0BAAQmE,cAAR,GAAyB,IAAIC,IAAJ,GAAWC,OAAX,EAAzB;AACD;AACDpF,kBAAEqF,GAAF,CAAMoB,cAAc,gBAApB,EAAsC1F,OAAtC,EACGwE,IADH,CACQ,UAASC,IAAT,EAAe;AACnB,sBAAIA,QAAQA,SAAS,EAArB,EAAyB;AACvB,wBAAMC,SAASC,KAAKC,KAAL,CAAWH,IAAX,CAAf;AACAI,4BAAQC,KAAR,CAAcJ,OAAO8B,OAArB;AACD;AACF,iBANH,EAOGnB,IAPH,CAOQ,UAASP,KAAT,EAAgB;AACpBD,0BAAQC,KAAR,CAAcA,KAAd;AACD,iBATH;AAUD;AACF;AACF;AA7ByD,SAA3C,CAAjB;AA+BD,OAjCD;;AAmCA,UAAM2B,iBAAiB,SAAjBA,cAAiB,CAAS5E,SAAT,EAAoB;AACzC;AACA;AACA,YAAM6E,OAAO7E,UAAUO,IAAV,CAAe,iBAAf,CAAb;AACA,YAAIsE,KAAK3E,MAAL,KAAgB,CAApB,EAAuB;AACrB;AACD;;AAED2E,aAAKrE,IAAL,CAAU,YAAW;AACnB,cAAMvC,QAAQ,IAAd;AACA,eAAK6G,SAAL,CAAeC,KAAf,CAAqB,GAArB,EAA0BV,GAA1B,CAA8B,UAASW,QAAT,EAAmB;AAC/C,gBAAIA,SAASrG,OAAT,CAAiB,MAAjB,MAA6B,CAAC,CAAlC,EAAqC;AACnC,kBAAMsG,UAAUD,SAASE,SAAT,CAAmB,CAAnB,CAAhB;AACA,kBAAI;AACF5H,yBAAS6H,WAAT,CAAqBF,OAArB,EAA8BhH,KAA9B,EAAqC+G,QAArC;AACD,eAFD,CAEE,OAAO/C,CAAP,EAAU;AACV,oBAAIA,aAAamD,SAAjB,EAA4B;AAC1B;AACA;AACD;AACF;AACF;AACF,WAZD;AAaD,SAfD;AAgBD,OAxBD;;AA0BA,UAAMC,YAAY,SAAZA,SAAY,CAASrF,SAAT,EAAoB;AACpC,YAAMsF,YAAYlI,EAAE,MAAF,EAAUwF,IAAV,CAAe,WAAf,CAAlB;AACA5C,kBAAUsD,IAAV,CACE,0CACEgC,SADF,GAEE,2EAHJ;AAKD,OAPD;;AASA,UAAMC,cAAc,SAAdA,WAAc,CAASvF,SAAT,EAAoBiF,OAApB,EAA6B;AAC/C,YAAMO,cAAcpI,EAAE,MAAF,EAAUwF,IAAV,CAAe,SAAf,CAApB;AACA,YAAM6C,gBAAgBD,cAAc,mBAApC;AACAH,kBAAUrF,SAAV;AACA,YAAI7B,UAAU,EAAED,WAAWA,SAAb,EAAwBmE,WAAW,IAAnC,EAAd;AACA,YAAIhE,IAAJ,EAAU;AACRF,kBAAQmE,cAAR,GAAyB,IAAIC,IAAJ,GAAWC,OAAX,EAAzB;AACD;AACDpF,UAAEqF,GAAF,CAAMgD,aAAN,EAAqBtH,OAArB,EACGwE,IADH,CACQ,UAASC,IAAT,EAAe;AACnB,cAAMU,OAAOlG,EAAEwF,IAAF,CAAb;AACA,cAAI,CAACU,KAAKpD,MAAV,EAAkB;AAChBF,sBAAU0F,MAAV;AACA;AACD;AACD1F,oBAAUsD,IAAV,CAAelG,EAAEwF,IAAF,CAAf;AACA;AACA,cAAI5D,QAAQ,IAAID,WAAJ,CAAgB,eAAhB,CAAZ;AACAiB,oBAAU,CAAV,EAAa2F,aAAb,CAA2B3G,KAA3B;AACA4F,yBAAe5E,SAAf;AACA,cAAM4F,YAAY5F,UAAUO,IAAV,CAAe,eAAf,CAAlB;AACA,cAAIqF,UAAU1F,MAAV,GAAmB,CAAvB,EAA0B;AACxB,gBAAM2F,WAAW/C,KAAKC,KAAL,CACf/C,UAAUO,IAAV,CAAe,YAAf,EAA6BmC,IAA7B,CAAkC,gBAAlC,CADe,CAAjB;AAGA,gBAAMoD,WAAW1I,yiBAAjB;AAYA,gBAAM2I,aAAa3I,EAAE,MAAF,EAAUwF,IAAV,CAAe,SAAf,CAAnB;AACA5C,sBAAUO,IAAV,CAAe,yBAAf,EAA0CC,IAA1C,CAA+C,YAAW;AACxD,kBAAIwF,mBAAmBF,SAASG,KAAT,EAAvB;AACA,kBAAIzB,SAASpH,EAAE,IAAF,EAAQwF,IAAR,CAAa,QAAb,CAAb;AACA,mBAAKsD,YAAL,CAAkB,YAAlB,EAAgCL,SAASrB,MAAT,EAAiB2B,KAAjD;AACAH,+BACGzF,IADH,CACQ,eADR,EAEGmC,IAFH,CAGI,MAHJ,EAIIqD,aACE,eADF,GAEEF,SAASrB,MAAT,EAAiB4B,SAFnB,GAGE,GAHF,GAIE5B,MARN;AAUAwB,+BACGzF,IADH,CACQ,qBADR,EAEGmC,IAFH,CAGI,MAHJ,EAIIqD,aACE,4BADF,GAEEvB,MAFF,GAGE,kBAHF,GAIEqB,SAASrB,MAAT,EAAiB2B,KARvB;AAUA,kBAAIN,SAASrB,MAAT,EAAiB6B,WAArB,EAAkC;AAChCjJ,kBAAE,IAAF,EAAQiG,QAAR,CAAiB,YAAjB;AACA2C,iCACGzF,IADH,CACQ,qBADR,EAEGH,MAFH,CAGIhD,EACE,qFADF,CAHJ;AAOD,eATD,MASO;AACL4I,iCACGzF,IADH,CACQ,qBADR,EAEGH,MAFH,CAGIhD,EACE,0GADF,CAHJ;AAOD;AACD4I,+BACGzF,IADH,CACQ,iBADR,EAEGmC,IAFH,CAGI,MAHJ,EAIIqD,aACE,iBADF,GAEEF,SAASrB,MAAT,EAAiB4B,SAFnB,GAGE,GAHF,GAIE5B,MARN;AAUApH,gBAAE,IAAF,EAAQkJ,OAAR,CAAgBN,gBAAhB;AACAhG,wBAAUO,IAAV,CAAe,kBAAf,EAAmCF,IAAnC;AACAa,gCAAkB,IAAlB;AACD,aAvDD;;AAyDA,gBAAI3C,OAAOgI,UAAP,GAAoB,GAAxB,EAA6B;AAC3B3C,4BAAc5D,SAAd;AACD;;AAED4F,sBAAUpF,IAAV,CAAe,YAAW;AACxBpD,gBAAE,IAAF,EAAQ4E,KAAR,CAAc,UAASC,CAAT,EAAY;AACxBA,kBAAEC,cAAF;AACAtC,oCAAoBxC,EAAE,IAAF,CAApB,EAA6B6E,EAAEuE,MAAF,CAAS1F,IAAtC;AACD,eAHD;AAID,aALD;AAMD;AACF,SAlGH,EAmGG0C,IAnGH,CAmGQ,UAASiD,GAAT,EAAc;AAClBzD,kBAAQ0D,KAAR,CAAcD,GAAd;AACA,cAAIE,OAAO,IAAIlJ,IAAJ,EAAX;AACA,cAAMmJ,SAAS,4BAAf;AACAD,eAAKE,WAAL,CAAiBD,MAAjB;AACA,cAAIE,IAAIH,KAAKI,cAAL,CAAoBH,MAApB,CAAR;AACA5G,oBAAUsD,IAAV,CACE,8BAA8BwD,EAAE,uBAAF,CAA9B,GAA2D,MAD7D;AAGD,SA5GH;AA6GD,OArHD;;AAuHA,UAAI,CAAC5I,SAAL,EAAgB;AACdD,cAAMiG,GAAN,CAAU9D,MAAV,CACE,8EADF;AAGD,OAJD,MAIO;AACLmF,oBAAYtH,MAAMiG,GAAlB;AACD;AACF;AA/XuB,GAAZ,CAAd;;AAkYA,SAAOxG,OAAP;AACD,CA7YD;;AA+YAsJ,QAAQ,CACN,0BADM,CAAR,EAEG,YAAY;AACb;AACD,CAJD;;AAMA7J,OAAO,yDAAP,EAAkE,YAAU,CAAE,CAA9E;;AAGA","file":"tiles-management-compiled.js","sourcesContent":["define('tiles-management-pattern', [\n  'jquery',\n  'pat-base',\n  'pat-registry',\n  'mockup-patterns-modal',\n  'mockup-patterns-sortable',\n  'mockup-i18n',\n  'babel-polyfill',\n], function($, Base, registry, Modal, Sortable, I18n) {\n  'use strict';\n  var Pattern = Base.extend({\n    name: 'tiles-management',\n    trigger: '.pat-tiles-management',\n    parser: 'mockup',\n    defaults: {},\n    init: function() {\n      const _this = this;\n      const managerId = this.options.managerId;\n      const useModal = this.options.useModal !== 'false';\n\n      const isIE = (function() {\n        var ua = window.navigator.userAgent;\n        var msie = ua.indexOf('MSIE ');\n        if (msie > 0) {\n          // IE 10 or older => return version number\n          return true;\n        }\n\n        var trident = ua.indexOf('Trident/');\n        if (trident > 0) {\n          // IE 11 => return version number\n          return true;\n        }\n\n        var edge = ua.indexOf('Edge/');\n        if (edge > 0) {\n          // IE 12 (aka Edge) => return version number\n          return true;\n        }\n\n        // other browser\n        return false;\n      })();\n\n      const customEventPolyfill = function() {\n        if (typeof window.CustomEvent === 'function') return false;\n\n        function CustomEvent(event, params) {\n          params = params || {\n            bubbles: false,\n            cancelable: false,\n            detail: undefined,\n          };\n          var evt = document.createEvent('CustomEvent');\n          evt.initCustomEvent(\n            event,\n            params.bubbles,\n            params.cancelable,\n            params.detail\n          );\n          return evt;\n        }\n\n        CustomEvent.prototype = window.Event.prototype;\n\n        window.CustomEvent = CustomEvent;\n      };\n\n      customEventPolyfill(); // for IE11 compatibility\n\n      const initializeAddButton = function(button, url) {\n        const $button = $(button);\n        var container = $button.next('.available-tiles');\n        if (container.length === 0) {\n          $button.parent().append('<div class=\"available-tiles\"></div>');\n          container = $button.next('.available-tiles');\n          container.hide();\n          container.load(url + ' #content .list-group', function() {\n            if (useModal) {\n              container.find('a.list-group-item').each(function() {\n                const addTileModal = new Modal($(this), {\n                  actionOptions: {\n                    redirectOnResponse: true,\n                    redirectToUrl: window.location.href,\n                  },\n                });\n                addTileModal.on('after-render', function() {\n                  $('form#add_tile').append(\n                    '<input type=\"hidden\" name=\"managerId\" value=\"' +\n                      managerId +\n                      '\" />'\n                  );\n                });\n              });\n            }\n\n            $(this).slideDown();\n          });\n        } else {\n          container.slideToggle();\n        }\n      };\n\n      const enableEditButtons = function(tile) {\n        //edit buttons modals\n        const $tile = $(tile);\n        if (useModal) {\n          $tile.find('div.tileEditButtons a.tileDeleteLink').each(function() {\n            const deleteModal = new Modal($(this), {\n              templateOptions: {\n                classModal: 'plone-modal-content delete-tile-modal',\n              },\n              actionOptions: {\n                redirectOnResponse: false,\n                onSuccess: function(self, response, state, xhr, form) {\n                  if (state === 'success') {\n                    self.hide();\n                    self.reloadWindow();\n                  }\n                },\n              },\n            });\n            deleteModal.on('after-render', function() {\n              $('form#delete_tile').append(\n                '<input type=\"hidden\" name=\"managerId\" value=\"' +\n                  managerId +\n                  '\" />'\n              );\n            });\n          });\n\n          $tile.find('div.tileEditButtons a.tileEditLink').each(function() {\n            const editModal = new Modal($(this), {\n              templateOptions: {\n                classModal: 'plone-modal-content edit-tile-modal',\n              },\n              actionOptions: {\n                redirectOnResponse: true,\n              },\n            });\n          });\n        }\n\n        $tile.find('div.tileEditButtons a.tileVisibilityLink').each(function() {\n          $(this).click(function(e) {\n            e.preventDefault();\n            let $element = $(e.currentTarget);\n            let options = { managerId: managerId, ajax_load: true };\n            if (isIE) {\n              options.invalidIECache = new Date().getTime();\n            }\n            $.get(`${$element.attr('href')} &managerId=` + managerId, options)\n              .done(function(data) {\n                if (data !== undefined) {\n                  const result = JSON.parse(data);\n                  console.error(result.error);\n                  return;\n                }\n\n                // 1. changes icon\n                let $span = $element.find('> span');\n                if ($span.hasClass('icon-view')) {\n                  $span\n                    .removeClass('icon-view')\n                    .addClass('glyphicon glyphicon-eye-close');\n                  $span.find('> span').html('Show');\n                } else {\n                  $span\n                    .removeClass('glyphicon glyphicon-eye-close')\n                    .addClass('icon-view');\n                  $span.find('> span').html('Hide');\n                }\n\n                // 2. changes tile background\n                $tile.toggleClass('hiddenTile');\n              })\n              .fail(function(error) {\n                console.error(error);\n              });\n          });\n        });\n\n        $tile\n          .mouseenter(function() {\n            $(this).addClass('editableTile');\n            $(this)\n              .find('.tileEditButtons')\n              .show();\n          })\n          .mouseleave(function() {\n            $(this).removeClass('editableTile');\n            $(this)\n              .find('.tileEditButtons')\n              .hide();\n          });\n      };\n\n      const enableSorting = function(container) {\n        const absoluteUrl = $('body').data().baseUrl || $('base').attr('href');\n        const sortable = new Sortable(container.find('.tilesList'), {\n          selector: 'div.tileWrapper',\n          drop: function($el, delta) {\n            if (delta !== 0) {\n              const tileIds = $('.tileWrapper').map(function(index, obj) {\n                return $(obj).data().tileid;\n              });\n              if (absoluteUrl !== undefined) {\n                let options = {\n                  managerId: managerId,\n                  ajax_load: true,\n                  tileIds: JSON.stringify(tileIds.get()),\n                  _authenticator: $el.data('token'),\n                };\n                if (isIE) {\n                  options.invalidIECache = new Date().getTime();\n                }\n                $.get(absoluteUrl + '/reorder_tiles', options)\n                  .done(function(data) {\n                    if (data && data !== '') {\n                      const result = JSON.parse(data);\n                      console.error(result.message);\n                    }\n                  })\n                  .fail(function(error) {\n                    console.error(error);\n                  });\n              }\n            }\n          },\n        });\n      };\n\n      const enablePatterns = function(container) {\n        // we need to manually enable patterns of tiles loaded with ajax because\n        // sometimes these are loaded after pattern inits\n        const tags = container.find('[class*=\"pat-\"]');\n        if (tags.length === 0) {\n          return;\n        }\n\n        tags.each(function() {\n          const _this = this;\n          this.className.split(' ').map(function(cssClass) {\n            if (cssClass.indexOf('pat-') !== -1) {\n              const pattern = cssClass.substring(4);\n              try {\n                registry.initPattern(pattern, _this, cssClass);\n              } catch (e) {\n                if (e instanceof TypeError) {\n                  //pattern already registered\n                  return;\n                }\n              }\n            }\n          });\n        });\n      };\n\n      const addLoader = function(container) {\n        const portalUrl = $('body').data('portalUrl');\n        container.html(\n          '<div class=\"loading-tiles\"><img src=\"' +\n            portalUrl +\n            '/++resource++redturtle.tiles.management/loader.svg\" alt=\"loading\"/></div>'\n        );\n      };\n\n      const loadManager = function(container, pattern) {\n        const contentlUrl = $('body').data('baseUrl');\n        const tilesInfosUrl = contentlUrl + '/tiles_management';\n        addLoader(container);\n        let options = { managerId: managerId, ajax_load: true };\n        if (isIE) {\n          options.invalidIECache = new Date().getTime();\n        }\n        $.get(tilesInfosUrl, options)\n          .done(function(data) {\n            const html = $(data);\n            if (!html.length) {\n              container.remove();\n              return;\n            }\n            container.html($(data));\n            //throw custom event to notify when tiles are loaded\n            var event = new CustomEvent('rtTilesLoaded');\n            container[0].dispatchEvent(event);\n            enablePatterns(container);\n            const addButton = container.find('.add-tile-btn');\n            if (addButton.length > 0) {\n              const tiledata = JSON.parse(\n                container.find('.tilesList').attr('data-tilesinfo')\n              );\n              const $buttons = $(\n                `<div class=\"tileEditButtons\" style=\"z-index:100000\">\n                  <a class=\"plone-btn plone-btn-info tileEditLink\" href=\"#\">\n                    <span class=\"icon-edit\" aria-hidden=\"true\"></span>\n                  </a>\n                  <a class=\"plone-btn plone-btn-warning tileVisibilityLink\" href=\"#\">\n                  </a>\n                  <a class=\"plone-btn plone-btn-danger tileDeleteLink\" href=\"#\">\n                    <span class=\"icon-delete\" aria-hidden=\"true\">&times;</span>\n                  </a>\n                </div>`\n              );\n              const portal_url = $('body').data('baseUrl');\n              container.find('.tilesList .tileWrapper').each(function() {\n                let $current_buttons = $buttons.clone();\n                let tileid = $(this).data('tileid');\n                this.setAttribute('data-token', tiledata[tileid].token);\n                $current_buttons\n                  .find('.tileEditLink')\n                  .attr(\n                    'href',\n                    portal_url +\n                      '/@@edit-tile/' +\n                      tiledata[tileid].tile_type +\n                      '/' +\n                      tileid\n                  );\n                $current_buttons\n                  .find('.tileVisibilityLink')\n                  .attr(\n                    'href',\n                    portal_url +\n                      '/@@show_hide_tiles?tileId=' +\n                      tileid +\n                      '&_authenticator=' +\n                      tiledata[tileid].token\n                  );\n                if (tiledata[tileid].tile_hidden) {\n                  $(this).addClass('hiddenTile');\n                  $current_buttons\n                    .find('.tileVisibilityLink')\n                    .append(\n                      $(\n                        '<span class=\"icon-view\" aria-hidden=\"true\"><span class=\"sr-only\">Show</span></span>'\n                      )\n                    );\n                } else {\n                  $current_buttons\n                    .find('.tileVisibilityLink')\n                    .append(\n                      $(\n                        '<span class=\"glyphicon glyphicon-eye-close\"  aria-hidden=\"true\"><span class=\"sr-only\">Hide</span></span>'\n                      )\n                    );\n                }\n                $current_buttons\n                  .find('.tileDeleteLink')\n                  .attr(\n                    'href',\n                    portal_url +\n                      '/@@delete-tile/' +\n                      tiledata[tileid].tile_type +\n                      '/' +\n                      tileid\n                  );\n                $(this).prepend($current_buttons);\n                container.find('.tileEditButtons').hide();\n                enableEditButtons(this);\n              });\n\n              if (window.innerWidth > 991) {\n                enableSorting(container);\n              }\n\n              addButton.each(function() {\n                $(this).click(function(e) {\n                  e.preventDefault();\n                  initializeAddButton($(this), e.target.href);\n                });\n              });\n            }\n          })\n          .fail(function(err) {\n            console.trace(err);\n            var i18n = new I18n();\n            const domain = 'redturtle.tiles.management';\n            i18n.loadCatalog(domain);\n            var _ = i18n.MessageFactory(domain);\n            container.html(\n              '<p class=\"error-manager\">' + _('error_loading_manager') + '</p>'\n            );\n          });\n      };\n\n      if (!managerId) {\n        _this.$el.append(\n          '<span>to use tiles manager, you need to provide a managerId attribute</span>'\n        );\n      } else {\n        loadManager(_this.$el);\n      }\n    },\n  });\n\n  return Pattern;\n});\n\nrequire([\n  'tiles-management-pattern',\n], function () {\n  'use strict';\n});\n\ndefine(\"src/redturtle/tiles/management/browser/static/bundle.js\", function(){});\n\n\n//# sourceMappingURL=tiles-management-compiled.js.map"]}